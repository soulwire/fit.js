/* Copyright (C) 2014 Justin Windle, http://soulwire.co.uk */
var fit=function(){"use strict";function t(t){return t.toUpperCase()}function e(t){return"number"==typeof t&&!isNaN(t)}function n(){return(new Date).getTime()}function i(t,e){for(var n=[],i=0,r=t.length;i<r;i++)n[i]=e(t[i]);return n}function r(t,e){for(var n in e)n in t||(t[n]=e[n]);return t}function o(e){if(!y)for(var n,i=H(C.body),r=w,o=0,a=T.length;o<a&&(y=T[o],n=y+r,!(n in i))&&(y=y.replace(/^(\w)/,t),n=y+r,!(n in i));o++);return y+e}function a(t){var e=H(t),n=e[o(w)].replace(/[a-z()]/gi,"").split(",");if(n.length<6)return[1,0,0,1,0,0];for(var i=0;i<6;i++)n[i]=parseFloat(n[i]);return n}function f(t,e){var n=a(e);n[0]=t.scale,n[3]=t.scale,n[4]+=t.tx,n[5]+=t.ty;var r=i(n,function(t){return t.toFixed(6)});e.style[o(m)]="0 0",e.style[o(w)]="matrix("+r.join(",")+")"}function s(t,e){var n=H(e),i=parseFloat(n.left)||0,r=parseFloat(n.top)||0;"static"===n.position&&(e.style.position="relative"),e.style.left=i+t.tx+b,e.style.top=r+t.ty+b,e.style.height=t.height+b,e.style.width=t.width+b}function l(t,e){var n=H(e),i=parseFloat(n.marginLeft)||0,r=parseFloat(n.marginTop)||0;e.style.marginLeft=i+t.tx+b,e.style.marginTop=r+t.ty+b,e.style.height=t.height+b,e.style.width=t.width+b}function h(t,e){e.height*=t.scale,e.width*=t.scale,e.x+=t.tx,e.y+=t.ty}function u(t){if(t.nodeType&&1==t.nodeType){var n=t.getBoundingClientRect();t={height:t.offsetHeight,width:t.offsetWidth,x:n.left,y:n.top}}return!e(t.x)&&e(t.left)&&(t.x=t.left),!e(t.y)&&e(t.top)&&(t.y=t.top),t}function g(){var t=n(),e=t-d;if(e<=x)clearInterval(v),v=setTimeout(g,x-e);else{for(var i=0,r=M.length;i<r;i++)M[i]();d=t}}function c(t,e,n,i,r){var o=u(t),a=u(e),s=0===o.width?R:o.width,l=0===o.height?P:o.height,g=0===a.width?I:a.width,c=0===a.height?P:a.height;R=s,B=l,I=g,P=c;var p=g/s,y=c/l,d=s/l,v=g/c,x=n.cover?y:p,m=n.cover?p:y,w=d>=v?x:m,T=s*w,F=l*w,L=n.hAlign==A?.5*(T-g):n.hAlign==O?T-g:0,b=n.vAlign==A?.5*(F-c):n.vAlign==E?F-c:0;return r=r||{},r.tx=a.x-L-o.x,r.ty=a.y-b-o.y,r.x=a.x-L-o.x*w,r.y=a.y-b-o.y*w,r.height=o.height*w,r.width=o.width*w,r.scale=w,i?i(r,t):n.apply&&(i="undefined"!=typeof HTMLElement&&t instanceof HTMLElement?f:h)(r,t),r}function p(t,e,n,i){if(!t||!e)throw"You must supply a target and a container";"function"==typeof n&&(i=n,n={}),n=r(n||{},N);var o=c(t,e,n,i);return n.watch&&(M.length||(z.addEventListener?z.addEventListener("resize",g):z.attachEvent("onresize",g)),o.trigger=function(){c(t,e,n,i,o)},o.on=function(t){var e=M.indexOf(o.trigger);~e||M.push(o.trigger),t||o.trigger()},o.off=function(){var t=M.indexOf(o.trigger);~t&&M.splice(t,1)},o.on(!0)),o}var y,d,v,x=50,m="TransformOrigin",w="Transform",T="moz ms o webkit".split(" "),A="center",E="bottom",O="right",F="left",L="top",b="px",z=window||self,C=document,H=z.getComputedStyle,M=[],N={hAlign:A,vAlign:A,watch:!1,cover:!1,apply:!0};Array.prototype.indexOf||(Array.prototype.indexOf=function(t){for(var e=0;e<this.length;++e)if(this[e]==t)return e;return-1});var R,B,I,P;return r(p,{watching:M,defaults:N,cssTransform:f,cssPosition:s,cssMargin:l,CENTER:A,BOTTOM:E,RIGHT:O,LEFT:F,TOP:L})}();"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports&&(exports=module.exports=fit),exports.fit=fit);