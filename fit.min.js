/* Copyright (C) 2014 Justin Windle, http://soulwire.co.uk */
var fit=function(){"use strict";function s(a){return a.toUpperCase()}function t(a){return"number"==typeof a&&!isNaN(a)}function u(){return(new Date).getTime()}function v(a,b){for(var c=[],d=0,e=a.length;d<e;d++)c[d]=b(a[d]);return c}function w(a,b){for(var c in b)c in a||(a[c]=b[c]);return a}function x(a){if(!o)for(var b,e=m(l.body),f=c,g=0,h=d.length;g<h&&(o=d[g],b=o+f,!(b in e))&&(o=o.replace(/^(\w)/,s),b=o+f,!(b in e));g++);return o+a}function y(a){var b=m(a),d=b[x(c)].replace(/[a-z()]/gi,"").split(",");if(d.length<6)return[1,0,0,1,0,0];for(var e=0;e<6;e++)d[e]=parseFloat(d[e]);return d}function z(a,d){var e=y(d);e[0]=a.scale,e[3]=a.scale,e[4]+=a.tx,e[5]+=a.ty;var f=v(e,function(a){return a.toFixed(6)});d.style[x(b)]="0 0",d.style[x(c)]="matrix("+f.join(",")+")"}function A(a,b){var c=m(b),d=parseFloat(c.left)||0,e=parseFloat(c.top)||0;"static"===c.position&&(b.style.position="relative"),b.style.left=d+a.tx+j,b.style.top=e+a.ty+j,b.style.height=a.height+j,b.style.width=a.width+j}function B(a,b){var c=m(b),d=parseFloat(c.marginLeft)||0,e=parseFloat(c.marginTop)||0;b.style.marginLeft=d+a.tx+j,b.style.marginTop=e+a.ty+j,b.style.height=a.height+j,b.style.width=a.width+j}function C(a,b){b.height*=a.scale,b.width*=a.scale,b.x+=a.tx,b.y+=a.ty}function D(a){if(a.nodeType&&1==a.nodeType){var b=a.getBoundingClientRect();a={height:a.offsetHeight,width:a.offsetWidth,x:b.left,y:b.top}}return!t(a.x)&&t(a.left)&&(a.x=a.left),!t(a.y)&&t(a.top)&&(a.y=a.top),a}function E(){var b=u(),c=b-p;if(c<=a)clearInterval(q),q=setTimeout(E,a-c);else{for(var d=0,e=n.length;d<e;d++)n[d]();p=b}}function J(a,b,c,d,h){var i=D(a),j=D(b),k=0===i.width?F:i.width,l=0===i.height?I:i.height,m=0===j.width?H:j.width,n=0===j.height?I:j.height;F=k,G=l,H=m,I=n;var o=m/k,p=n/l,q=k/l,r=m/n,s=c.cover?p:o,t=c.cover?o:p,u=q>=r?s:t,v=k*u,w=l*u,x=c.hAlign==e?.5*(v-m):c.hAlign==g?v-m:0,y=c.vAlign==e?.5*(w-n):c.vAlign==f?w-n:0;return h=h||{},h.tx=j.x-x-i.x,h.ty=j.y-y-i.y,h.x=j.x-x-i.x*u,h.y=j.y-y-i.y*u,h.height=i.height*u,h.width=i.width*u,h.scale=u,d?d(h,a):c.apply&&(d="undefined"!=typeof HTMLElement&&a instanceof HTMLElement?z:C)(h,a),h}function K(a,b,c,d){if(!a||!b)throw"You must supply a target and a container";"function"==typeof c&&(d=c,c={}),c=w(c||{},r);var e=J(a,b,c,d);return c.watch&&(n.length||(k.addEventListener?k.addEventListener("resize orientationchange",E):k.attachEvent("onresize onorientationchange",E)),e.trigger=function(){J(a,b,c,d,e)},e.on=function(a){var b=n.indexOf(e.trigger);~b||n.push(e.trigger),a||e.trigger()},e.off=function(){var a=n.indexOf(e.trigger);~a&&n.splice(a,1)},e.on(!0)),e}var o,p,q,a=50,b="TransformOrigin",c="Transform",d="moz ms o webkit".split(" "),e="center",f="bottom",g="right",h="left",i="top",j="px",k=window||self,l=document,m=k.getComputedStyle,n=[],r={hAlign:e,vAlign:e,watch:!1,cover:!1,apply:!0};Array.prototype.indexOf||(Array.prototype.indexOf=function(a){for(var b=0;b<this.length;++b)if(this[b]==a)return b;return-1});var F,G,H,I;return w(K,{watching:n,defaults:r,cssTransform:z,cssPosition:A,cssMargin:B,CENTER:e,BOTTOM:f,RIGHT:g,LEFT:h,TOP:i})}();"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports&&(exports=module.exports=fit),exports.fit=fit);